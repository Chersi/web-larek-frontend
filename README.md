# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание проекта
Интернет-магазин представляет собой веб-приложение для онлайн-продажи товаров с полным циклом обработки заказов от просмотра каталога до оформления покупки. 

### Основные компоненты системы:
* Главная страница служит точкой входа в систему и содержит основной каталог товаров

* Каталог товаров предоставляет пользователям возможность просмотра доступных позиций с возможностью детального ознакомления

* Корзина покупок позволяет управлять выбранными товарами и оформлять заказы

* Система оформления заказа обеспечивает полный процесс покупки от выбора способа оплаты до ввода данных для оформления заказа

### Ключевые функциональные возможности:
* Просмотр каталога товаров с возможностью детального ознакомления через модальные окна

* Добавление и удаление товаров в корзину

* Многошаговая система оформления заказа с валидацией данных

* Управление контактной информацией покупателя

* Выбор способа оплаты и подтверждение покупки

### Особенности реализации:
#### Проект построен с учетом удобства использования и включает следующие функциональные элементы:

* Модальные окна с возможностью закрытия через крестик или клик вне окна

* Валидация данных на всех этапах оформления заказа

* Пошаговая система оформления с контролем доступности переходов

* Уведомления об ошибках при некорректном заполнении форм

* Подтверждение оплаты с удалением товаров из корзины после успешной транзакции

## Архитектура проекта (MVP)
Архитектура проекта разработана с использованием паттерна MVP, в котором основными слоями являются: Model - модель данных, которая отвечает за работу с данными, View - компоненты представления, отвечающие за отображение данных на экране, Presenter - презентер, обеспечивающий взаимодействием между слоями данных (Model, View). Код презентера не выделен в отдельный класс, а содержится в основном скрипте index.ts. 


## ProductModel
ProductModel — класс для управления товарами, корзиной и оформлением заказа. Наследует базовый класс Model и реализует функциональность работы с продуктами, корзиной покупок и оформлением заказа.

## Свойства
* items: IProduct[] — массив всех доступных товаров

* basket: IProduct[] — корзина пользователя (изначально пустая)

* order: IOrder — объект заказа с полями адреса, email и телефона

* formErrors: FormErrors — объект для хранения ошибок валидации формы

## Методы
### Управление товарами
* getProducts(): IProduct[] — возвращает список всех товаров

* getProduct(id: string): IProduct — получает товар по ID

* setItems(items: IProduct[]) — устанавливает массив товаров

* selectedItem(id: string) — переключает статус добавления товара в корзину

### Корзина
* addCardToBasket(item: IProduct) — добавляет товар в корзину

* deleteFromBasket(id: string) — удаляет товар из корзины

* quantityItemsInBasket(): number — возвращает количество товаров в корзине

* basketTotal(): number — вычисляет общую сумму корзины

* clearBasket() — очищает корзину

### Заказ
* setOrderField(field: keyof IOrderForm, value: string) — устанавливает значение поля заказа

* getPayMethod(): string — получает способ оплаты

* movingCardsToOrder() — перемещает товары из корзины в заказ

* clearOrder() — очищает данные заказа

* availabilityInOrder(id: string, isIncluded: boolean) — управляет включением товара в заказ

### Валидация
* validateOrder(): boolean — проверяет корректность заполнения формы заказа

* setStatusAddToBasket(id: string, status: boolean) — устанавливает статус добавления товара в корзину

### Вспомогательные методы
* resetSelectedAll() — сбрасывает все выбранные товары в каталоге

## Component
Component — абстрактный базовый класс для создания компонентов пользовательского интерфейса. Предназначен для унификации работы с DOM-элементами в дочерних компонентах.

## Управление классами
* toggleClass(element: HTMLElement, className: string, force?: boolean) — добавляет или удаляет CSS-класс у элемента. При указании force работает как add/remove

## Работа с текстом
* setText(element: HTMLElement, value: unknown) — устанавливает текстовое содержимое элемента

## Управление состоянием
* setDisabled(element: HTMLElement, state: boolean) — включает/отключает элемент

* setHidden(element: HTMLElement) — скрывает элемент

* setVisible(element: HTMLElement) — показывает элемент

## Работа с изображениями
* setImage(element: HTMLImageElement, src: string, alt?: string) — устанавливает источник и альтернативный текст для изображения

## Метод рендеринга
* render(data?: Partial<T>): HTMLElement — основной метод рендеринга компонента. Принимает опциональные данные для обновления состояния и возвращает корневой DOM-элемент.

## EventEmitter
EventEmitter — реализация паттерна Publisher-Subscriber (издатель-подписчик) для организации взаимодействия между компонентами через систему событий.

## Свойства
* _events: Map<EventName, Set\<Subscriber>> — хранилище подписчиков по событиям

## Методы
## Управление подписками
* on<T>(eventName: EventName, callback: (event: T) => void) — подписка на событие с указанием обработчика

* off(eventName: EventName, callback: Subscriber) — отписка от события

* onAll(callback: (event: EmitterEvent) => void) — подписка на все события

* offAll() — очистка всех подписок

## Работа с событиями
* emit\<T>(eventName: string, data?: T) — отправка события с данными

* trigger\<T>(eventName: string, context?: Partial<T>) — создание функции-триггера для генерации события

## Model
Model — абстрактный базовый класс для создания моделей данных в приложении. Представляет собой основу для реализации паттерна Model-View-Controller (MVC).

## Свойства
* events: IEvents — защищённое свойство для работы с системой событий

## Методы
* emitChanges(event: string, payload?: object) — метод для уведомления подписчиков об изменении модели:

1. event: string — имя события

2. payload: object — опциональные данные события

3. отправляет событие через систему событий

4. использует пустой объект по умолчанию, если payload не передан

## Page
Page — компонент, представляющий основную страницу приложения. Наследует базовый класс Component и реализует логику управления основными элементами интерфейса.

## Свойства
* container: HTMLElement — корневой элемент компонента (наследуется от Component)

* events: IEvents — система событий (защищённое свойство)

* _counter: HTMLElement — элемент счетчика товаров в корзине

* _catalog: HTMLElement — контейнер каталога товаров

* _wrapper: HTMLElement — обертка страницы

* _basket: HTMLElement — элемент корзины

## Сеттеры
* counter: устанавливает значение счетчика товаров

* catalog: обновляет содержимое каталога

* locked: управляет состоянием блокировки страницы:

1. добавляет класс ‘page__wrapper_locked’ при true

2. удаляет класс при false

## События
* basket:open — генерируется при клике на элемент корзины

## Card
Card — компонент для отображения карточки товара. Наследует базовый класс Component и реализует логику отображения и управления карточкой продукта.

## Свойства
* container: HTMLElement — корневой элемент карточки (наследуется от Component)

* cardId: string — идентификатор карточки

* cardDescription: HTMLElement — элемент описания товара

* cardImage: HTMLImageElement — изображение товара

* cardTitle: HTMLElement — заголовок карточки

* cardCategory: HTMLElement — категория товара

* cardPrice: HTMLElement — цена товара

* cardButton: HTMLButtonElement — кнопка действия

* _statusAddToBasket: boolean — статус добавления в корзину

## Сеттеры и геттеры
* id: управление ID карточки через dataset

* description: установка текстового описания

* image: установка изображения с альтернативным текстом

* title: управление заголовком карточки

* category: установка категории с обновлением стилей:

1. принимает значение типа IProductCategory

2. обновляет текст и классы элемента

* price: управление ценой:

1. форматирует число с разделителями

2. устанавливает текст в формате “XXX синапсов”

3. управляет доступностью кнопки

* statusAddToBasket: управление статусом добавления в корзину

* active: управление активным состоянием карточки

## Метод рендеринга
* render(data: Partial\<IProduct>): HTMLElement — обновляет состояние карточки данными

## Basket
Basket — компонент, представляющий корзину товаров. Наследует базовый класс Component и реализует логику отображения и управления содержимым корзины.

## Свойства
* container: HTMLElement — корневой элемент (наследуется от Component)

* _list: HTMLElement — список товаров

* _total: HTMLElement — общая сумма

* _button: HTMLButtonElement — кнопка действия

## Сеттеры
* items: управление списком товаров:

1. обновляет содержимое списка

2. управляет доступностью кнопки

* selected: управление выбранным элементом

* total: установка общей суммы с форматированием

## Методы
* updateSelected() — обновляет индексы элементов в списке

* disableButton() — отключает кнопку

## CardBasket
* CardBasket — компонент для отображения отдельной карточки товара в корзине.

## Свойства
* container: HTMLElement — корневой элемент (наследуется от Component)

* cardId: string — идентификатор товара

* cardTitle: HTMLElement — название товара

* cardPrice: HTMLElement — цена товара

* cardButton: HTMLButtonElement — кнопка удаления

* basketItemIndex: HTMLElement — индекс элемента в списке

## Order
Order — компонент формы заказа, наследующий базовый класс Form. Предназначен для управления данными заказа и обработки способов оплаты.

## Свойства
* container: HTMLFormElement — корневой элемент формы (наследуется от Form)

* buttonCard: HTMLButtonElement — кнопка выбора оплаты картой

* buttonCash: HTMLButtonElement — кнопка выбора оплаты наличными

* formErrors: FormErrors — объект ошибок валидации

* totalPrice: number — общая сумма заказа

* events: IEvents — система событий

## Сеттеры
* total: установка общей суммы заказа:

1. обновляет внутреннее значение

2. отображает сумму в интерфейсе

* address: установка адреса

* email: установка email

* phone: установка телефона

* selectPaymentMethod: выбор способа оплаты:

1. обновляет значение в форме

2. управляет визуальным состоянием кнопок

## Методы
* clearPayment() — сброс выбора способа оплаты:

1. очищает значение в форме

2. убирает визуальные маркеры выбора

## Success
Success — компонент, отображающий успешное завершение заказа. Наследует базовый класс Component и реализует логику отображения информации об успешной операции.

## Свойства
* container: HTMLElement — корневой элемент (наследуется от Component)

* _close: HTMLButtonElement — кнопка закрытия

* _description: HTMLElement — элемент с описанием операции

* actions: ISuccessActions — объект действий

## Сеттер
* description: установка описания операции:

1. принимает числовое значение

2. форматирует значение с помощью formatNumber

3. отображает информацию о списании средств

4. обрабатывает случай бесплатного заказа

## Form
Form — базовый класс для создания форм, наследующий Component. Предоставляет базовую функциональность для работы с формами, валидацией и обработкой событий.

## Свойства
* container: HTMLFormElement — корневой элемент формы

* events: IEvents — система событий

* _submit: HTMLButtonElement — кнопка отправки

* _errors: HTMLElement — элемент отображения ошибок

## Методы
* onInputChange(field: keyof T, value: string) — обработка изменения поля:

1. эмитит событие изменения поля

2. принимает имя поля и новое значение

* render(state: Partial\<T> & IFormState) — метод рендеринга:

1. разделяет состояние на валидацию, ошибки и входные данные

2. обновляет состояние компонента

3. возвращает контейнер формы

## Сеттеры
* valid: управление доступностью кнопки отправки

* errors: установка текста ошибок

## Modal
Modal — компонент для создания модальных окон. Наследует базовый класс Component и реализует логику отображения и управления модальными окнами.

## Свойства
* container: HTMLElement — корневой элемент модального окна (наследуется от Component)

* events: IEvents — система событий

* _close: HTMLButtonElement — кнопка закрытия

* _content: HTMLElement — контейнер контента

* _pageWrapper: HTMLElement — обертка страницы

## Методы управления
* open() — открытие модального окна:

1. добавляет класс активности

2. эмитит событие ‘modal:open’

* close() — закрытие модального окна:

1. удаляет класс активности

2. очищает контент

3. эмитит событие ‘modal:close’

## Сеттеры
* content: установка содержимого модального окна

* locked: управление блокировкой страницы: добавляет/удаляет класс блокировки

## Метод рендеринга
* render(data: IModal): HTMLElement — обновляет состояние модального окна:

1. вызывает базовый рендеринг

2. открывает модальное окно

3. возвращает контейнер

## Api
Api — базовый класс для работы с API, обеспечивающий абстракцию над fetch API и обработку HTTP-запросов.

## Свойства
* baseUrl: string — базовая URL-строка API (только для чтения)

* options: RequestInit — настройки запроса

## Защищенные методы
* handleResponse(response: Response): Promise<object> — обработка ответа:

1. проверяет статус ответа

2. парсит JSON

3. обрабатывает ошибки

4. выбрасывает ошибку с сообщением при неудачном ответе

## Публичные методы
* get(uri: string) — выполнение GET-запроса:

1. формирует полный URL

2. применяет базовые настройки

3. обрабатывает ответ

* post(uri: string, data: object, method: ApiPostMethods) — выполнение POST/PUT/DELETE-запроса:

1. принимает URI, данные и метод

2. сериализует данные в JSON

3. применяет базовые настройки

4. обрабатывает ответ

## CardAPI
CardAPI — класс для работы с API карточек товаров и заказов. Наследует базовый класс Api и реализует интерфейс ICardAPI.

## Свойства
* baseUrl: string — базовый URL API (наследуется от Api)

* cdn: string — URL для загрузки изображений

* options: RequestInit — настройки запроса (наследуется от Api)

## Методы
* getCardItem(id: string): Promise\<IProduct> — получение карточки товара:

1. делает GET-запрос к API

2. дополняет URL изображения CDN

3. возвращает расширенную информацию о товаре

* getCardList(): Promise\<IProduct[]> — получение списка карточек:

1. делает GET-запрос к API

2. обрабатывает ответ в формате ApiListResponse

3. дополняет URL изображений CDN для всех элементов

4. возвращает массив карточек

* postProductOrder(order: IOrder): Promise\<IOrderResult> — отправка заказа:

1. делает POST-запрос с данными заказа

2. возвращает результат обработки заказа


## :book: Выполнено в ходе обучения на курсе "Фулстек-разработчик"
[![Баннер Яндекс Практикум](https://i.pinimg.com/736x/c7/a2/e1/c7a2e1cc33998b9baf5d974490086ee8.jpg "По ссылке все доступные курсы Практикума")](https://practicum.yandex.ru/referrals/?ref_code=gAAAAABoYQ_eKoertBLBPddzVr2ViPu-YV9FR0ddZZM0n9uiTm1YKWXpFJ77n6wvt4uQTR2iYDH7VLOVVE5jFruO987np6PxXw%3D%3D)